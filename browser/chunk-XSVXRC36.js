import{$a as w,Da as _,Eb as I,Fb as E,Ga as f,Gb as U,Hb as T,Ib as k,Jb as z,Kb as N,Na as m,Oa as s,Pa as i,R as u,Ra as b,S as g,Sa as C,Ta as a,Ya as y,Za as p,ab as S,bb as v,cb as M,db as P,qa as l,vb as O,wb as V,xb as F,ya as h}from"./chunk-XL47MIO6.js";import"./chunk-Q7L6LLAK.js";function L(o,t){if(o&1&&(s(0,"option",7),p(1),i()),o&2){let e=t.$implicit;m("value",e.symbol),l(),S("",e.name," (",e.symbol,")")}}function R(o,t){if(o&1&&(s(0,"div",8),p(1),i()),o&2){let e=a(2);y("success",e.popupSuccess)("error",!e.popupSuccess),l(),w(" ",e.popupMessage," ")}}function W(o,t){if(o&1){let e=b();s(0,"div",1)(1,"h2"),p(2,"Upload CSV for Existing Crypto"),i(),s(3,"label"),p(4,"Select Coin:"),i(),s(5,"select",2),P("ngModelChange",function(n){u(e);let c=a();return M(c.selectedCoin,n)||(c.selectedCoin=n),g(n)}),f(6,L,2,3,"option",3),i(),s(7,"label"),p(8,"Select CSV File:"),i(),s(9,"input",4),C("change",function(n){u(e);let c=a();return g(c.onFileSelected(n))}),i(),s(10,"button",5),C("click",function(){u(e);let n=a();return g(n.uploadCSV())}),p(11,"Upload"),i(),f(12,R,2,5,"div",6),i()}if(o&2){let e=a();l(5),v("ngModel",e.selectedCoin),l(),m("ngForOf",e.coins),l(6),m("ngIf",e.popupMessage)}}var D=class o{constructor(t){this.cryptoService=t}coins=[];selectedCoin=null;csvFile=null;popupMessage="";popupSuccess=!0;isBrowser=typeof window<"u";ngOnInit(){this.cryptoService.getAll().subscribe(t=>{this.coins=t,this.coins.length>0&&(this.selectedCoin=this.coins[0].symbol)})}onFileSelected(t){let e=t.target;e?.files&&e.files.length>0?this.csvFile=e.files[0]:this.csvFile=null}uploadCSV(){if(!this.selectedCoin||!this.csvFile){this.showPopup("Please select a coin and a CSV file.",!1);return}let t=new FileReader;t.onload=()=>{let r=t.result.trim().split(`
`);if(r.length<2){this.showPopup("CSV file is empty or invalid.",!1);return}let n=r[0].split(",").map(d=>d.trim().toLowerCase());if(n[0]!=="timestamp"||n[1]!=="symbol"||n[2]!=="price"){this.showPopup("CSV header must be: timestamp,symbol,price",!1);return}if(r.slice(1).filter(d=>d.split(",")[1].trim().toUpperCase()!==this.selectedCoin).length>0){this.showPopup(`CSV contains rows that do not match selected coin: ${this.selectedCoin}`,!1);return}let A=r.slice(1).map(d=>{let[x,,B]=d.split(",");return{date:new Date(Number(x)).toISOString().split("T")[0],price:Number(B)}});this.showPopup(`CSV for ${this.selectedCoin} uploaded successfully! ${A.length} rows.`,!0)},t.onerror=()=>{this.showPopup("Error reading file.",!1)},t.readAsText(this.csvFile)}showPopup(t,e){this.popupMessage=t,this.popupSuccess=e,setTimeout(()=>this.popupMessage="",4e3)}static \u0275fac=function(e){return new(e||o)(h(N))};static \u0275cmp=_({type:o,selectors:[["upload-crypto"]],decls:1,vars:1,consts:[["class","upload-container",4,"ngIf"],[1,"upload-container"],[3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","file","accept",".csv",3,"change"],[3,"click"],["class","popup",3,"success","error",4,"ngIf"],[3,"value"],[1,"popup"]],template:function(e,r){e&1&&f(0,W,13,3,"div",0),e&2&&m("ngIf",r.isBrowser)},dependencies:[F,O,V,z,T,k,U,I,E],styles:[".upload-container[_ngcontent-%COMP%]{max-width:500px;margin:2rem auto;padding:1.5rem;background-color:#f4f7f9;border-radius:12px;box-shadow:0 4px 12px #00000014;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem;padding:1rem 2rem;font-size:1.4rem;font-weight:700;color:#fff;border-radius:12px;background:linear-gradient(135deg,#1a73e8,#00c6ff);box-shadow:0 4px 8px #0003;text-transform:uppercase;letter-spacing:1px}label[_ngcontent-%COMP%]{display:block;margin-top:1rem;font-weight:600;color:#444;font-size:14px}select[_ngcontent-%COMP%], input[type=file][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{width:100%;margin-top:.5rem;padding:.6rem .8rem;border-radius:8px;border:1px solid #ccc;font-size:14px;box-sizing:border-box;transition:border-color .3s,box-shadow .3s}select[_ngcontent-%COMP%]:focus, input[type=file][_ngcontent-%COMP%]:focus{border-color:#007bff;box-shadow:0 0 6px #007bff4d;outline:none}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;margin-top:1rem;padding:.7rem 1rem;border-radius:8px;cursor:pointer;transition:background .2s ease,transform .2s ease;font-weight:600}button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px)}.popup[_ngcontent-%COMP%]{margin-top:1rem;padding:.8rem 1rem;border-radius:8px;font-weight:600;text-align:center;font-size:14px;box-shadow:0 2px 6px #0000000d}.popup.success[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;border:1px solid #c3e6cb}.popup.error[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}@media(max-width:600px){.upload-container[_ngcontent-%COMP%]{margin:1rem;padding:1rem;max-width:100%}h2[_ngcontent-%COMP%]{font-size:1.2rem;padding:.8rem 1rem}label[_ngcontent-%COMP%]{font-size:13px}select[_ngcontent-%COMP%], input[type=file][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{font-size:13px;padding:.55rem .75rem}.popup[_ngcontent-%COMP%]{font-size:13px;padding:.7rem .9rem}}@media(max-width:400px){h2[_ngcontent-%COMP%]{font-size:1.05rem;letter-spacing:.5px}.upload-container[_ngcontent-%COMP%]{padding:.8rem}}"]})};export{D as UploadCrypto};
